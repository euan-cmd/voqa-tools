<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hotel EV Charging RoI Calculator - Voqa</title>
    <meta name="description" content="Calculate how many additional room bookings you need to justify your EV charging investment for hotels">
    <meta name="keywords" content="EV charging, hotel investment, ROI calculator, electric vehicle, charging infrastructure, hospitality">
    <meta name="author" content="Voqa">

    <!-- Open Graph / Social Media -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="Hotel EV Charging Investment Calculator - Voqa">
    <meta property="og:description" content="Professional ROI calculator for hotel EV charging infrastructure planning">
    <meta property="og:url" content="https://euan-cmd.github.io/hotelevcalculator">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Hotel EV Charging Investment Calculator - Voqa">
    <meta name="twitter:description" content="Professional ROI calculator for hotel EV charging infrastructure planning">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Red+Hat+Display:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Red Hat Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        }

        :root {
            --primary: #005C80;
            --primary-dark: #004A6B;
            --accent: #F7D7BC;
            --accent-light: #F8D4B4;
            --success: #098C47;
            --danger: #FF4747;
            --text-dark: #0E215A;
            --text-light: #ffffff;
            --bg-light: #f8f9fa;
            --border: #E8F0F0;
            --font-family: 'Red Hat Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        }

        body {
            font-family: var(--font-family);
            background: var(--primary);
            min-height: 100vh;
            color: var(--text-light);
            line-height: 1.6;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 50%, rgba(247, 215, 188, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(0, 92, 128, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 20%, rgba(255, 255, 255, 0.05) 0%, transparent 40%);
            pointer-events: none;
            z-index: 1;
        }

        /* Common animation classes */
        .animate-slide-down {
            animation: slideDown 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        .animate-fade-in {
            animation: fadeIn 0.8s ease-out;
        }

        .animate-fade-in-up {
            animation: fadeInUp 0.8s ease-out;
        }

        .animate-slide-right {
            animation: slideRight 0.6s ease-out;
        }

        @keyframes slideDown {
            from { transform: translateY(-100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideRight {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideLeft {
            from { opacity: 0; transform: translateX(30px); }
            to { opacity: 1; transform: translateX(0); }
        }

        @keyframes expand {
            from { width: 0; }
            to { width: 80px; }
        }

        @keyframes countUp {
            from { opacity: 0; transform: scale(0.5); }
            to { opacity: 1; transform: scale(1); }
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .header {
            background: rgba(0, 92, 128, 0.95);
            backdrop-filter: blur(20px);
            padding: 24px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .back-to-calculators {
            position: absolute;
            top: 20px;
            left: 40px;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            color: rgba(255, 255, 255, 0.9);
            padding: 10px 16px;
            border-radius: 25px;
            font-size: 14px;
            font-weight: 500;
            text-decoration: none;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
            animation: fadeIn 0.8s ease-out 0.6s both;
        }

        .back-to-calculators:hover {
            background: rgba(255, 255, 255, 0.15);
            color: var(--text-light);
            transform: translateY(-1px);
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 40px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            gap: 20px;
        }

        .header-title {
            font-size: clamp(24px, 5vw, 36px);
            font-weight: 800;
            color: var(--text-light);
            letter-spacing: -0.5px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            line-height: 1.2;
        }

        /* Common button style */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: var(--accent);
            color: var(--primary);
            padding: 16px 24px;
            border-radius: 50px;
            font-size: clamp(14px, 2.5vw, 16px);
            font-weight: 700;
            text-decoration: none;
            letter-spacing: 0.3px;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            border: none;
            position: relative;
            overflow: hidden;
            text-align: center;
            min-height: 48px;
            justify-content: center;
            cursor: pointer;
            font-family: var(--font-family);
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }

        .btn:hover::before {
            width: 300px;
            height: 300px;
        }

        .btn:hover {
            transform: translateY(-2px) scale(1.05);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
            display: grid;
            grid-template-columns: 1.5fr 1fr;
            gap: 40px;
            position: relative;
            z-index: 2;
        }

        .card {
            background: rgba(255, 255, 255, 0.98);
            color: var(--text-dark);
            padding: 32px;
            border-radius: 20px;
            backdrop-filter: blur(20px);
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
            position: relative;
            overflow: hidden;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--primary);
            transform: scaleX(0);
            transform-origin: left;
            transition: transform 0.4s ease;
        }

        .card:hover::before {
            transform: scaleX(1);
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .section-title {
            font-size: clamp(22px, 4vw, 28px);
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 30px;
            letter-spacing: -0.5px;
            position: relative;
            line-height: 1.2;
        }

        .section-subtitle {
            font-size: 20px;
            font-weight: 700;
            color: var(--primary);
            margin: 30px 0 20px 0;
            letter-spacing: -0.3px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-group {
            margin-bottom: 24px;
        }

        .form-group:nth-child(n) {
            animation: fadeIn 0.6s ease-out backwards;
        }

        .form-group:nth-child(1) { animation-delay: 0.1s; }
        .form-group:nth-child(2) { animation-delay: 0.2s; }
        .form-group:nth-child(3) { animation-delay: 0.3s; }
        .form-group:nth-child(4) { animation-delay: 0.4s; }
        .form-group:nth-child(5) { animation-delay: 0.5s; }

        label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--text-dark);
            font-size: 14px;
            letter-spacing: 0.3px;
            transition: color 0.3s ease;
        }

        .form-group:hover label {
            color: var(--primary);
        }

        input, select {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 16px;
            background: white;
            color: var(--text-dark);
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            font-weight: 500;
            min-height: 48px;
            box-sizing: border-box;
            font-family: var(--font-family);
        }

        input:hover, select:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 92, 128, 0.1);
        }

        input:focus, select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 4px rgba(0, 92, 128, 0.1);
            transform: translateY(-2px);
        }

        .helper-text {
            margin-top: 8px;
            font-size: 12px;
            font-style: italic;
            color: #666;
        }

        .calculation-display {
            background: var(--primary);
            padding: 24px;
            border-radius: 16px;
            margin-top: 12px;
            border-left: 6px solid var(--accent);
            box-shadow: 0 8px 25px rgba(0, 92, 128, 0.2);
            position: relative;
            overflow: hidden;
            animation: slideUp 0.5s ease-out;
        }

        .calc-header {
            font-size: 18px;
            font-weight: 700;
            color: var(--text-light);
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
            font-family: var(--font-family);
        }

        .calc-explainer {
            font-size: 13px;
            color: rgba(255, 255, 255, 0.9);
            line-height: 1.5;
            font-style: italic;
            position: relative;
            z-index: 1;
            font-family: var(--font-family);
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .result-card {
            background: var(--primary);
            padding: 24px;
            border-radius: 16px;
            position: relative;
            overflow: hidden;
            animation: slideUp 0.5s ease-out;
            color: var(--text-light);
            text-align: center;
            transition: transform 0.3s ease;
        }

        .result-card:hover {
            border: 2px solid var(--accent);
        }

        .result-icon {
            font-size: 48px;
            margin-bottom: 16px;
            display: block;
        }

        .result-value {
            font-size: clamp(24px, 6vw, 32px);
            font-weight: 800;
            color: var(--accent);
            margin-bottom: 8px;
            position: relative;
            z-index: 1;
            animation: countUp 1s ease-out;
            line-height: 1.1;
        }

        .result-label {
            font-size: 14px;
            font-weight: 600;
            color: var(--text-light);
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            z-index: 1;
        }

        .result-description {
            font-size: 12px;
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.4;
            position: relative;
            z-index: 1;
        }

        .breakdown-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        .breakdown-section {
            background: white;
            padding: 20px;
            border-radius: 12px;
            border: 1px solid var(--border);
        }

        .breakdown-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 15px;
        }

        .breakdown-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            font-size: 14px;
        }

        .breakdown-label {
            color: var(--text-dark);
        }

        .breakdown-value {
            font-weight: 600;
        }

        .breakdown-value.positive {
            color: var(--success);
        }

        .breakdown-value.negative {
            color: var(--danger);
        }

        .breakdown-total {
            border-top: 2px solid var(--border);
            padding-top: 10px;
            margin-top: 10px;
            font-weight: 700;
            font-size: 16px;
        }

        .insights-box {
            background: #E8F0F0;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 8px 30px rgba(0, 92, 128, 0.12);
            margin-top: 30px;
            animation: slideLeft 0.6s ease-out;
        }

        .insights-title {
            font-size: 22px;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 20px;
            letter-spacing: -0.3px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .insights-title::before {
            content: '📊';
            font-size: 24px;
        }

        .insight-item {
            margin-bottom: 15px;
            font-size: 16px;
            color: var(--text-dark);
            padding-left: 20px;
            position: relative;
            line-height: 1.6;
        }

        .insight-item::before {
            content: '•';
            position: absolute;
            left: 0;
            color: var(--primary);
            font-weight: bold;
            font-size: 18px;
        }

        .insight-item strong {
            color: var(--primary);
            font-weight: 700;
        }

        .chart-container {
            background: white;
            padding: 24px;
            border-radius: 16px;
            box-shadow: 0 8px 30px rgba(0, 92, 128, 0.1);
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .chart-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--primary);
        }

        .chart-title {
            font-size: 20px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 20px;
            text-align: center;
        }

        .cta-container {
            margin-top: 30px;
            text-align: center;
            background: rgba(255, 255, 255, 0.98);
            color: var(--text-dark);
            padding: 30px;
            border-radius: 16px;
            backdrop-filter: blur(20px);
            position: relative;
            overflow: hidden;
        }

        .guidance-section {
            margin-top: 30px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 16px;
            animation: slideLeft 0.6s ease-out;
        }

        .guidance-title {
            color: var(--primary);
            font-size: 20px;
            font-weight: 800;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .guidance-title::before {
            content: '💡';
            font-size: 24px;
        }

        .guidance-text {
            font-size: 14px;
            color: var(--text-dark);
            line-height: 1.6;
            margin-bottom: 15px;
        }

        /* Media Queries */
        @media (max-width: 900px) {
            .container {
                grid-template-columns: 1fr;
                gap: 30px;
                padding: 30px 20px;
            }

            .header-content {
                padding: 0 20px;
                gap: 15px;
            }

            .back-to-calculators {
                left: 20px;
                top: 16px;
                padding: 8px 14px;
                font-size: 13px;
            }

            .results-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .breakdown-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }
        }

        @media (max-width: 600px) {
            .back-to-calculators {
                position: relative;
                left: auto;
                top: auto;
                margin: 0 auto 20px auto;
                display: inline-flex;
            }

            .header-content {
                margin-top: 20px;
            }
        }

        @media (prefers-reduced-motion: reduce) {
            * {
                animation: none !important;
                transition: none !important;
            }
        }
    </style>
</head>
<body>
    <div class="header animate-slide-down">
        <a href="https://euan-cmd.github.io/voqa-tools/" class="back-to-calculators">
            ← Back to Calculators
        </a>
        <div class="header-content">
            <div class="header-title animate-fade-in">🏨 Hotel EV Charging RoI Calculator</div>
            <a href="https://calendar.app.google/C919wsfwk71WB3Qo6" target="_blank" class="btn">
                📅 Book some time with Voqa to talk about EV Charging
            </a>
        </div>
    </div>

    <div class="container animate-fade-in-up">
        <div class="card">
            <h2 class="section-title animate-slide-right">⚙️ Configure Your Setup</h2>
            
            <div class="guidance-section">
                <h4 class="guidance-title">How to Use This Calculator</h4>
                <div class="guidance-text">
                    This tool calculates exactly how many additional room bookings you need to justify your EV charging investment. 
                    For example: "If I install 4 charging bays costing £13,600, how many extra guests do I need per week to break even?"
                </div>
                <div class="guidance-text">
                    The calculator factors in EV charging revenue, room margins, F&B spend, and shows your complete ROI timeline with cash flow projections.
                    Use realistic assumptions based on your local EV adoption rates and hotel performance.
                </div>
            </div>
            
            <div class="input-section">
                <h3 class="section-subtitle">Hotel Details</h3>
                
                <div class="form-group">
                    <label for="totalRooms">Total Rooms</label>
                    <input type="number" id="totalRooms" value="50" min="1">
                </div>

                <div class="form-group">
                    <label for="adr">Average Daily Rate (£)</label>
                    <input type="number" id="adr" value="120" min="0" step="0.01">
                </div>

                <div class="form-group">
                    <label for="baselineOccupancy">Current Occupancy (%)</label>
                    <input type="number" id="baselineOccupancy" value="70" min="0" max="100" step="1">
                </div>

                <div class="form-group">
                    <label for="avgFBSpend">Average F&B Spend per Room (£)</label>
                    <input type="number" id="avgFBSpend" value="18" min="0" step="0.01">
                </div>
            </div>

            <div class="input-section">
                <h3 class="section-subtitle">Investment Costs</h3>
                
                <div class="form-group">
                    <label for="equipmentCost">Equipment Cost per Bay (£)</label>
                    <input type="number" id="equipmentCost" value="1400" min="0" step="0.01">
                </div>

                <div class="form-group">
                    <label for="installationCost">Installation Cost per Bay (£)</label>
                    <input type="number" id="installationCost" value="2000" min="0" step="0.01">
                </div>

                <div class="form-group">
                    <label for="chargingBays">Number of Charging Bays</label>
                    <input type="number" id="chargingBays" value="4" min="1" step="1">
                </div>

                <div class="form-group">
                    <label for="annualMaintenance">Annual Maintenance per Bay (£)</label>
                    <input type="number" id="annualMaintenance" value="150" min="0" step="0.01">
                </div>
            </div>

            <div class="input-section">
                <h3 class="section-subtitle">EV Charging Parameters</h3>
                
                <div class="form-group">
                    <label for="pricePerKwh">Price per kWh (£)</label>
                    <input type="number" id="pricePerKwh" value="0.40" min="0" step="0.01">
                    <div class="helper-text">Price exclusive of VAT</div>
                </div>

                <div class="form-group">
                    <label for="electricityCostPerKwh">Electricity Cost per kWh (£)</label>
                    <input type="number" id="electricityCostPerKwh" value="0.25" min="0" step="0.01">
                    <div class="helper-text">Cost exclusive of VAT</div>
                </div>

                <div class="form-group">
                    <label for="transactionFeePerKwh">Voqa Transaction Fee per kWh (£)</label>
                    <input type="number" id="transactionFeePerKwh" value="0.06" min="0" step="0.01" disabled>
                    <div class="helper-text">Fee exclusive of VAT</div>
                </div>

                <div class="form-group">
                    <label for="avgKwhPerSession">Average kWh per Session</label>
                    <input type="number" id="avgKwhPerSession" value="30" min="0" step="0.1">
                </div>

                <div class="form-group">
                    <label for="sessionsPerBayPerDay">Sessions per Bay per Day</label>
                    <input type="number" id="sessionsPerBayPerDay" value="0.5" min="0" step="0.1">
                </div>
            </div>

            <div class="input-section">
                <h3 class="section-subtitle">Cost & Margin Assumptions</h3>
                
                <div class="form-group">
                    <label for="evGuestsWithAncillarySpend">EV Guests with F&B Spend (%)</label>
                    <input type="number" id="evGuestsWithAncillarySpend" value="50" min="0" max="100" step="1">
                </div>

                <div class="form-group">
                    <label for="roomVariableCostPercent">Room Variable Cost (%)</label>
                    <input type="number" id="roomVariableCostPercent" value="25" min="0" max="100" step="1">
                    <div class="helper-text">Variable costs as % of room revenue</div>
                </div>

                <div class="form-group">
                    <label for="fbMarginPercent">F&B Gross Margin (%)</label>
                    <input type="number" id="fbMarginPercent" value="65" min="0" max="100" step="1">
                </div>

                <div class="form-group">
                    <label for="desiredPaybackMonths">Desired Payback Period (Months)</label>
                    <input type="number" id="desiredPaybackMonths" value="36" min="6" max="120" step="1">
                    <div class="helper-text">Target timeframe to recover initial investment</div>
                </div>
            </div>
        </div>

        <div class="card">
            <h2 class="section-title">📊 Investment Analysis</h2>
            
            <div class="results-grid">
                <div class="result-card">
                    <span class="result-icon">📅</span>
                    <div class="result-value" id="additionalBookingsPerWeek">-</div>
                    <div class="result-label">Additional Bookings per Week</div>
                    <div class="result-description">Weekly booking increase required</div>
                </div>
                
                <div class="result-card">
                    <span class="result-icon">📈</span>
                    <div class="result-value" id="occupancyIncrease">-</div>
                    <div class="result-label">Occupancy Increase</div>
                    <div class="result-description">Required percentage point increase</div>
                </div>
                
                <div class="result-card">
                    <span class="result-icon">💰</span>
                    <div class="result-value" id="marginPerBooking">-</div>
                    <div class="result-label">Margin per Booking</div>
                    <div class="result-description">Combined room and F&B margin</div>
                </div>
            </div>

            <div class="breakdown-grid">
                <div class="breakdown-section">
                    <div class="breakdown-title">Investment Costs</div>
                    <div class="breakdown-item">
                        <span class="breakdown-label">Total Investment:</span>
                        <span class="breakdown-value negative" id="totalCapex">-</span>
                    </div>
                </div>
                
                <div class="breakdown-section">
                    <div class="breakdown-title">EV Charging Contribution</div>
                    <div class="breakdown-item">
                        <span class="breakdown-label">Annual Charging Revenue:</span>
                        <span class="breakdown-value positive" id="annualChargingRevenue">-</span>
                    </div>
                    <div class="breakdown-item">
                        <span class="breakdown-label">Less: Energy & Transaction Costs:</span>
                        <span class="breakdown-value negative" id="combinedEnergyCosts">-</span>
                    </div>
                    <div class="breakdown-item">
                        <span class="breakdown-label">Less: Operating Costs:</span>
                        <span class="breakdown-value negative" id="totalAnnualOpex">-</span>
                    </div>
                    <div class="breakdown-item breakdown-total">
                        <span class="breakdown-label">Net EV Contribution:</span>
                        <span class="breakdown-value positive" id="netEVChargingContribution">-</span>
                    </div>
                </div>
            </div>

            <div class="insights-box">
                <div class="insights-title">Key Insights</div>
                <div class="insight-item">
                    You need <strong id="insightBookingsNeeded">-</strong> to reach break-even on your <strong id="insightInvestmentAmount">-</strong> EV charging investment
                </div>
                <div class="insight-item">
                    This equals <strong id="insightBookingsPerWeek">-</strong> extra bookings per week or a <strong id="insightOccupancyIncrease">-</strong> occupancy increase
                </div>
                <div class="insight-item">
                    EV charging will contribute <strong id="insightEVContribution">-</strong>, leaving <strong id="insightRemainingAmount">-</strong> to be covered by additional room bookings
                </div>
                <div class="insight-item">
                    Each additional booking generates <strong id="insightMarginPerBooking">-</strong> margin (room + F&B)
                </div>
                <div class="insight-item">
                    Your new occupancy rate would be <strong id="insightNewOccupancy">-</strong> vs current <strong id="insightCurrentOccupancy">-</strong>
                </div>
            </div>

            <div class="cta-container">
                <a href="https://calendar.app.google/C919wsfwk71WB3Qo6" target="_blank" class="btn">
                    🗓️ Book some time with Voqa to talk about EV Charging
                </a>
                
                <div style="margin-top: 20px; padding-top: 15px; border-top: 2px solid var(--accent);">
                    <p style="color: var(--text-dark); font-size: 14px; line-height: 1.6; margin-bottom: 15px;">
                        <strong>Beyond Financial Returns:</strong> EV charging infrastructure provides additional benefits including enhanced guest satisfaction, 
                        competitive differentiation, sustainability credentials, and future-proofing your property for the growing EV market.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Cash Flow Charts Section -->
    <div class="container">
        <div class="card" style="grid-column: 1 / -1;">
            <h3 class="section-subtitle">📈 Cash Flow Analysis</h3>
            
            <div class="chart-container">
                <div class="chart-title">Annual Cash Flow Analysis</div>
                <div class="chart-wrapper">
                    <canvas id="cashFlowChart" width="800" height="300"></canvas>
                </div>
                <div class="calc-explainer" style="margin-top: 15px; color: var(--text-dark); text-align: center;">
                    This chart shows your yearly cash flow. The red bar represents the initial investment, 
                    while the green bars show annual profits from combined EV charging and additional room bookings.
                    <strong>Note:</strong> EV charging revenue grows by <span id="growthRateDisplay">5%</span> annually to reflect increased utilization.
                </div>
            </div>

            <div class="chart-container">
                <div class="chart-title">Cumulative Cash Flow Analysis</div>
                <div class="chart-wrapper">
                    <canvas id="cumulativeChart" width="800" height="300"></canvas>
                </div>
                <div class="calc-explainer" style="margin-top: 15px; color: var(--text-dark); text-align: center;">
                    This chart tracks your total accumulated cash position year by year. The break-even point shows when 
                    your total cash position returns to zero, indicating full recovery of your initial investment.
                </div>
            </div>

            <div class="results-grid" style="margin-top: 30px;">
                <div class="result-card">
                    <span class="result-icon">💰</span>
                    <div class="result-value" id="chartInvestmentInsight">-</div>
                    <div class="result-label">Initial Investment</div>
                    <div class="result-description">Total upfront cost for EV charging infrastructure</div>
                </div>
                <div class="result-card">
                    <span class="result-icon">⏱️</span>
                    <div class="result-value" id="chartBreakEvenInsight">-</div>
                    <div class="result-label">Break-even Time</div>
                    <div class="result-description">Time to recover initial investment</div>
                </div>
                <div class="result-card">
                    <span class="result-icon">📈</span>
                    <div class="result-value" id="chartFiveYearProfitInsight">-</div>
                    <div class="result-label">5-Year Profit</div>
                    <div class="result-description">Total profit after 5 years of operation</div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js" integrity="sha512-ElRFoEQdI5Ht6kZvyzXhYG9NqjtkmlkfYk0wr6wHxU9JEHakS7UJZNeml5ALk+8IKlU6jDgMabC3vkumRokgJA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script>
        // Global variables
        let currentCalculationData = {};
        let cashFlowChart = null;
        let cumulativeChart = null;

        // Utility functions
        const formatCurrency = (amount) => {
            if (amount < 0) {
                return '(£' + Math.abs(amount).toLocaleString('en-GB', {minimumFractionDigits: 0, maximumFractionDigits: 0}) + ')';
            }
            return '£' + amount.toLocaleString('en-GB', {minimumFractionDigits: 0, maximumFractionDigits: 0});
        };

        const formatNumber = (num, decimals = 1) => {
            return num.toLocaleString('en-GB', {minimumFractionDigits: decimals, maximumFractionDigits: decimals});
        };

        const getInputValue = (id, defaultValue = 0) => {
            const element = document.getElementById(id);
            return element ? (parseFloat(element.value) || defaultValue) : defaultValue;
        };

        const updateElement = (id, value) => {
            const element = document.getElementById(id);
            if (element) element.textContent = value;
        };

        // Chart generation function
        function generateCharts() {
            const { totalCapex, netAdditionalMargin, baseEVContribution, annualUsageGrowth, totalAnnualOpex } = currentCalculationData;
            
            const yearsToShow = 8;
            const years = [];
            const annualCashFlow = [];
            const cumulative = [];
            
            let cumulativeTotal = -totalCapex;
            
            for (let year = 0; year <= yearsToShow; year++) {
                if (year === 0) {
                    years.push('Initial');
                    annualCashFlow.push(-totalCapex);
                    cumulative.push(cumulativeTotal);
                } else {
                    const growthFactor = Math.pow(1 + annualUsageGrowth, year);
                    const evContributionThisYear = baseEVContribution * growthFactor;
                    const netEVContributionThisYear = evContributionThisYear - totalAnnualOpex;
                    const totalMarginThisYear = netEVContributionThisYear + (netAdditionalMargin - (baseEVContribution - totalAnnualOpex));
                    
                    years.push(`Year ${year}`);
                    annualCashFlow.push(totalMarginThisYear);
                    cumulativeTotal += totalMarginThisYear;
                    cumulative.push(cumulativeTotal);
                }
            }

            // Destroy existing charts
            if (cashFlowChart) cashFlowChart.destroy();
            if (cumulativeChart) cumulativeChart.destroy();

            // Common chart options
            const commonOptions = {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: false },
                    tooltip: {
                        backgroundColor: 'rgba(0, 92, 128, 0.9)',
                        titleColor: '#fff',
                        bodyColor: '#fff',
                        borderColor: '#F7D7BC',
                        borderWidth: 2,
                        cornerRadius: 8,
                        padding: 12
                    }
                },
                animation: {
                    duration: 1000,
                    easing: 'easeInOutQuart'
                }
            };

            // Cash Flow Chart
            const cashFlowCtx = document.getElementById('cashFlowChart').getContext('2d');
            cashFlowChart = new Chart(cashFlowCtx, {
                type: 'bar',
                data: {
                    labels: years,
                    datasets: [{
                        label: 'Annual Cash Flow',
                        data: annualCashFlow,
                        backgroundColor: annualCashFlow.map(value => value < 0 ? '#FF4747' : '#098C47'),
                        borderColor: annualCashFlow.map(value => value < 0 ? '#FF4747' : '#098C47'),
                        borderWidth: 2,
                        borderRadius: 8
                    }]
                },
                options: {
                    ...commonOptions,
                    plugins: {
                        ...commonOptions.plugins,
                        tooltip: {
                            ...commonOptions.plugins.tooltip,
                            callbacks: {
                                label: (context) => 'Cash Flow: ' + formatCurrency(context.parsed.y)
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: { color: 'rgba(0, 92, 128, 0.1)', drawBorder: false },
                            ticks: {
                                callback: (value) => formatCurrency(value),
                                color: '#666',
                                font: { 
                                    size: 12, 
                                    weight: '500',
                                    family: 'Red Hat Display'
                                }
                            },
                            title: {
                                display: true,
                                text: 'Annual Cash Flow (£)',
                                color: '#005C80',
                                font: { weight: 'bold', size: 14, family: 'Red Hat Display' }
                            }
                        },
                        x: {
                            grid: { display: false },
                            ticks: { 
                                color: '#666', 
                                font: { 
                                    size: 12, 
                                    weight: '500',
                                    family: 'Red Hat Display'
                                } 
                            },
                            title: {
                                display: true,
                                text: 'Year',
                                color: '#005C80',
                                font: { weight: 'bold', size: 14, family: 'Red Hat Display' }
                            }
                        }
                    }
                }
            });

            // Cumulative Chart
            const cumulativeCtx = document.getElementById('cumulativeChart').getContext('2d');
            
            cumulativeChart = new Chart(cumulativeCtx, {
                type: 'line',
                data: {
                    labels: years,
                    datasets: [{
                        label: 'Cumulative Cash Flow',
                        data: cumulative,
                        borderColor: '#005C80',
                        backgroundColor: 'rgba(0, 92, 128, 0.1)',
                        borderWidth: 3,
                        fill: true,
                        tension: 0.3,
                        pointBackgroundColor: cumulative.map(value => value < 0 ? '#FF4747' : '#098C47'),
                        pointBorderColor: cumulative.map(value => value < 0 ? '#FF4747' : '#098C47'),
                        pointRadius: 6,
                        pointHoverRadius: 8,
                        pointBorderWidth: 2,
                        pointHoverBorderWidth: 3
                    }]
                },
                options: {
                    ...commonOptions,
                    plugins: {
                        ...commonOptions.plugins,
                        tooltip: {
                            ...commonOptions.plugins.tooltip,
                            callbacks: {
                                label: (context) => 'Cumulative: ' + formatCurrency(context.parsed.y)
                            }
                        }
                    },
                    scales: {
                        y: {
                            grid: {
                                color: (context) => context.tick.value === 0 ? '#FF4747' : 'rgba(0, 92, 128, 0.1)',
                                lineWidth: (context) => context.tick.value === 0 ? 2 : 1,
                                drawBorder: false
                            },
                            ticks: {
                                callback: (value) => formatCurrency(value),
                                color: '#666',
                                font: { 
                                    size: 12, 
                                    weight: '500',
                                    family: 'Red Hat Display'
                                }
                            },
                            title: {
                                display: true,
                                text: 'Cumulative Cash Position (£)',
                                color: '#005C80',
                                font: { weight: 'bold', size: 14, family: 'Red Hat Display' }
                            }
                        },
                        x: {
                            grid: { display: false },
                            ticks: { 
                                color: '#666', 
                                font: { 
                                    size: 12, 
                                    weight: '500',
                                    family: 'Red Hat Display'
                                } 
                            },
                            title: {
                                display: true,
                                text: 'Year',
                                color: '#005C80',
                                font: { weight: 'bold', size: 14, family: 'Red Hat Display' }
                            }
                        }
                    },
                    animation: { duration: 1500, easing: 'easeInOutQuart' }
                }
            });

            // Update chart insights
            const additionalRoomContributionPerYear = netAdditionalMargin - (baseEVContribution - totalAnnualOpex);
            
            // Calculate break-even time using the same growth model as payback calculation
            let breakEvenTime = 0;
            let cumulativeRecovered = 0;
            
            for (let year = 1; year <= 10; year++) {
                const growthFactor = Math.pow(1 + annualUsageGrowth, year);
                const evContributionThisYear = baseEVContribution * growthFactor;
                const netEVContributionThisYear = evContributionThisYear - totalAnnualOpex;
                const totalContributionThisYear = netEVContributionThisYear + additionalRoomContributionPerYear;
                
                cumulativeRecovered += totalContributionThisYear;
                
                if (cumulativeRecovered >= totalCapex && breakEvenTime === 0) {
                    // Calculate fractional year based on how much was recovered in previous years
                    const previousYearRecovered = cumulativeRecovered - totalContributionThisYear;
                    const remainingToRecover = totalCapex - previousYearRecovered;
                    const fractionOfYear = remainingToRecover / totalContributionThisYear;
                    breakEvenTime = (year - 1) + fractionOfYear;
                    break;
                }
            }
            
            const fiveYearProfit = (netAdditionalMargin * 5) - totalCapex;
            
            updateElement('chartInvestmentInsight', formatCurrency(totalCapex));
            
            const breakEvenMonths = Math.round(breakEvenTime * 12);
            const breakEvenDisplay = breakEvenMonths === 12 ? "1 year" :
                                   breakEvenMonths < 12 ? `${breakEvenMonths} months` :
                                   breakEvenMonths % 12 === 0 ? `${breakEvenMonths / 12} years` :
                                   `${Math.floor(breakEvenMonths / 12)} years ${breakEvenMonths % 12} months`;
            
            updateElement('chartBreakEvenInsight', breakEvenDisplay);
            updateElement('chartFiveYearProfitInsight', formatCurrency(fiveYearProfit));
        }

        // Main calculation function
        function calculate() {
            try {
                // Get input values with defaults
                const inputs = {
                    totalRooms: getInputValue('totalRooms', 50),
                    adr: getInputValue('adr', 120),
                    baselineOccupancy: getInputValue('baselineOccupancy', 70) / 100,
                    avgFBSpend: getInputValue('avgFBSpend', 18),
                    equipmentCost: getInputValue('equipmentCost', 1400),
                    installationCost: getInputValue('installationCost', 2000),
                    chargingBays: getInputValue('chargingBays', 4),
                    annualMaintenance: getInputValue('annualMaintenance', 150),
                    pricePerKwh: getInputValue('pricePerKwh', 0.40),
                    avgKwhPerSession: getInputValue('avgKwhPerSession', 30),
                    electricityCostPerKwh: getInputValue('electricityCostPerKwh', 0.25),
                    transactionFeePerKwh: getInputValue('transactionFeePerKwh', 0.06),
                    roomVariableCostPercent: getInputValue('roomVariableCostPercent', 25) / 100,
                    fbMarginPercent: getInputValue('fbMarginPercent', 65) / 100,
                    evGuestsWithAncillarySpend: getInputValue('evGuestsWithAncillarySpend', 50) / 100,
                    sessionsPerBayPerDay: getInputValue('sessionsPerBayPerDay', 0.5),
                    desiredPaybackYears: getInputValue('desiredPaybackMonths', 36) / 12
                };

                const annualUsageGrowth = 0.05; // Fixed at 5%

                // Calculate investment costs
                const totalCapex = (inputs.equipmentCost + inputs.installationCost) * inputs.chargingBays;
                const totalAnnualOpex = inputs.annualMaintenance * inputs.chargingBays;

                // EV Charging calculations
                const chargingRevenuePerSession = inputs.avgKwhPerSession * inputs.pricePerKwh;
                const electricityCostPerSession = inputs.avgKwhPerSession * inputs.electricityCostPerKwh;
                const transactionFeePerSession = inputs.avgKwhPerSession * inputs.transactionFeePerKwh;
                const chargingGrossMarginPerSession = chargingRevenuePerSession - electricityCostPerSession - transactionFeePerSession;

                const dailyChargingRevenue = inputs.chargingBays * inputs.sessionsPerBayPerDay * chargingRevenuePerSession;
                const dailyChargingGrossMargin = inputs.chargingBays * inputs.sessionsPerBayPerDay * chargingGrossMarginPerSession;
                const dailyElectricityCosts = inputs.chargingBays * inputs.sessionsPerBayPerDay * electricityCostPerSession;
                const dailyTransactionFees = inputs.chargingBays * inputs.sessionsPerBayPerDay * transactionFeePerSession;
                
                const annualChargingRevenue = dailyChargingRevenue * 365;
                const annualChargingGrossMargin = dailyChargingGrossMargin * 365;
                const annualElectricityCosts = dailyElectricityCosts * 365;
                const annualTransactionFees = dailyTransactionFees * 365;
                const baseEVContribution = annualChargingGrossMargin;

                const netEVChargingContribution = annualChargingGrossMargin - totalAnnualOpex;

                // Room booking calculations
                const roomGrossMargin = inputs.adr * (1 - inputs.roomVariableCostPercent);
                const fbGrossMargin = inputs.avgFBSpend * inputs.evGuestsWithAncillarySpend * inputs.fbMarginPercent;
                const totalMarginPerAdditionalBooking = roomGrossMargin + fbGrossMargin;

                // Calculate cumulative EV contribution over payback period
                let cumulativeEVContribution = 0;
                for (let year = 1; year <= inputs.desiredPaybackYears; year++) {
                    const growthFactor = Math.pow(1 + annualUsageGrowth, year);
                    const evContributionThisYear = baseEVContribution * growthFactor;
                    const netEVContributionThisYear = evContributionThisYear - totalAnnualOpex;
                    cumulativeEVContribution += netEVContributionThisYear;
                }

                // Calculate additional bookings needed
                const remainingToRecoverFromBookings = Math.max(0, totalCapex - cumulativeEVContribution);
                const additionalBookingsNeededPerYear = remainingToRecoverFromBookings > 0 ? 
                    Math.ceil(remainingToRecoverFromBookings / (totalMarginPerAdditionalBooking * inputs.desiredPaybackYears)) : 0;
                
                const totalAdditionalBookingsNeeded = additionalBookingsNeededPerYear * inputs.desiredPaybackYears;
                const additionalBookingsPerWeek = additionalBookingsNeededPerYear / 52;
                const additionalBookingsPerDay = additionalBookingsNeededPerYear / 365;

                // Calculate occupancy impact
                const occupancyIncreasePercent = additionalBookingsPerDay / inputs.totalRooms;
                const newOccupancyRate = inputs.baselineOccupancy + occupancyIncreasePercent;

                // Additional revenue calculations
                const additionalRoomRevenue = additionalBookingsNeededPerYear * inputs.adr;
                const additionalFBRevenue = additionalBookingsNeededPerYear * inputs.avgFBSpend * inputs.evGuestsWithAncillarySpend;
                const additionalRoomGrossMargin = additionalRoomRevenue * (1 - inputs.roomVariableCostPercent);
                const additionalFBGrossMargin = additionalFBRevenue * inputs.fbMarginPercent;

                const totalAdditionalGrossMargin = additionalRoomGrossMargin + additionalFBGrossMargin + annualChargingGrossMargin;
                const netAdditionalMargin = totalAdditionalGrossMargin - totalAnnualOpex;

                // Update UI elements
                updateElement('additionalBookingsPerWeek', formatNumber(additionalBookingsPerWeek, 1));
                updateElement('occupancyIncrease', (occupancyIncreasePercent * 100).toFixed(1) + '%');
                updateElement('marginPerBooking', formatCurrency(Math.round(totalMarginPerAdditionalBooking)));

                updateElement('totalCapex', formatCurrency(totalCapex));
                updateElement('annualChargingRevenue', formatCurrency(annualChargingRevenue));
                updateElement('combinedEnergyCosts', formatCurrency(annualElectricityCosts + annualTransactionFees));
                updateElement('totalAnnualOpex', formatCurrency(totalAnnualOpex));
                updateElement('netEVChargingContribution', formatCurrency(netEVChargingContribution));

                // Update insights
                updateElement('insightBookingsNeeded', totalAdditionalBookingsNeeded.toLocaleString() + ` total additional bookings over ${inputs.desiredPaybackYears} years`);
                updateElement('insightInvestmentAmount', formatCurrency(totalCapex));
                updateElement('insightBookingsPerWeek', formatNumber(additionalBookingsPerWeek, 1) + ' extra bookings per week');
                updateElement('insightOccupancyIncrease', (occupancyIncreasePercent * 100).toFixed(1) + '% occupancy increase');
                updateElement('insightEVContribution', formatCurrency(cumulativeEVContribution) + ` over ${inputs.desiredPaybackYears} years`);
                updateElement('insightRemainingAmount', formatCurrency(remainingToRecoverFromBookings));
                updateElement('insightMarginPerBooking', formatCurrency(Math.round(totalMarginPerAdditionalBooking)) + ' margin');
                updateElement('insightNewOccupancy', (newOccupancyRate * 100).toFixed(1) + '%');
                updateElement('insightCurrentOccupancy', (inputs.baselineOccupancy * 100).toFixed(0) + '%');

                updateElement('growthRateDisplay', '5%');

                // Store calculation data
                currentCalculationData = {
                    totalCapex,
                    totalAnnualOpex,
                    annualChargingRevenue,
                    annualChargingGrossMargin,
                    annualElectricityCosts,
                    annualTransactionFees,
                    netEVChargingContribution,
                    additionalBookingsNeeded: additionalBookingsNeededPerYear,
                    additionalBookingsPerDay,
                    occupancyIncreasePercent,
                    newOccupancyRate,
                    totalMarginPerAdditionalBooking,
                    roomGrossMargin,
                    fbGrossMargin,
                    netAdditionalMargin,
                    baseEVContribution,
                    annualUsageGrowth,
                    additionalBookingsPerWeek,
                    desiredPaybackYears: inputs.desiredPaybackYears,
                    totalAdditionalBookingsNeeded,
                    cumulativeEVContribution
                };

                generateCharts();

            } catch (error) {
                console.error('Calculation error:', error);
            }
        }

        // Setup interactive effects
        function setupInteractiveEffects() {
            try {
                const formGroups = document.querySelectorAll('.form-group');
                formGroups.forEach(group => {
                    const input = group.querySelector('input, select');
                    if (input) {
                        input.addEventListener('focus', function() {
                            group.style.transform = 'translateX(5px)';
                        });
                        input.addEventListener('blur', function() {
                            group.style.transform = 'translateX(0)';
                        });
                    }
                });
            } catch (error) {
                console.error('Error setting up interactive effects:', error);
            }
        }

        // Initialize application
        function initializeApp() {
            try {
                const inputIds = [
                    'totalRooms', 'adr', 'baselineOccupancy', 'avgFBSpend',
                    'equipmentCost', 'installationCost', 'chargingBays', 'annualMaintenance',
                    'pricePerKwh', 'electricityCostPerKwh', 'transactionFeePerKwh', 
                    'avgKwhPerSession', 'sessionsPerBayPerDay', 'evGuestsWithAncillarySpend',
                    'roomVariableCostPercent', 'fbMarginPercent', 'desiredPaybackMonths'
                ];

                inputIds.forEach(id => {
                    const element = document.getElementById(id);
                    if (element) {
                        element.addEventListener('input', calculate);
                    }
                });

                setupInteractiveEffects();
                calculate();

            } catch (error) {
                console.error('Error initializing app:', error);
            }
        }

        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            try {
                initializeApp();
            } catch (error) {
                console.error('Failed to initialize app:', error);
                // Fallback: try again after a short delay
                setTimeout(initializeApp, 100);
            }
        });
    </script>
</body>
</html>
